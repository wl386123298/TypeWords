<script setup lang="ts">
import { computed, ref } from 'vue'
import BasePage from '@/components/BasePage.vue'
import BaseButton from '@/components/BaseButton.vue'

// ç±»å‹å®šä¹‰
interface Resource {
  name: string
  description?: string
  difficulty?: string
  link: string
  author?: string
  features?: string
  suitable?: string
}

interface Subcategory {
  name: string
  description?: string
  resources: Resource[]
}

interface Category {
  id: string
  name: string
  icon: string
  description?: string
  resources?: Resource[]
  subcategories?: Subcategory[]
}

// èµ„æºåˆ†ç±»
const categories = ref<Category[]>([
  {
    id: 'new-concept',
    name: 'æ–°æ¦‚å¿µè‹±è¯­',
    icon: 'ğŸ“š',
    description: 'ç»å…¸è‹±è¯­æ•™æï¼Œé€‚åˆç³»ç»Ÿå­¦ä¹ ',
    resources: [
      {
        name: 'æ–°æ¦‚å¿µè‹±è¯­ç¬¬ä¸€å†Œ',
        description: 'é€‚åˆè‹±è¯­åˆå­¦è€…',
        difficulty: 'å…¥é—¨',
        link: 'https://pan.quark.cn/s/92a317cf1a16',
      },
      {
        name: 'æ–°æ¦‚å¿µè‹±è¯­ç¬¬äºŒå†Œ',
        description: 'åŸºç¡€è‹±è¯­å­¦ä¹ ï¼Œå·©å›ºè¯­æ³•å’Œè¯æ±‡',
        difficulty: 'åŸºç¡€',
        link: 'https://pan.quark.cn/s/1ee9c8a7e8e2',
      },
      {
        name: 'æ–°æ¦‚å¿µè‹±è¯­ç¬¬ä¸‰å†Œ',
        description: 'æé«˜è‹±è¯­æ°´å¹³ï¼Œå¢å¼ºé˜…è¯»èƒ½åŠ›',
        difficulty: 'è¿›é˜¶',
        link: 'https://pan.quark.cn/s/b35c2859812a',
      },
      {
        name: 'æ–°æ¦‚å¿µè‹±è¯­ç¬¬å››å†Œ',
        description: 'é«˜çº§è‹±è¯­å­¦ä¹ ï¼Œæå‡ç»¼åˆèƒ½åŠ›',
        difficulty: 'é«˜çº§',
        link: 'https://pan.quark.cn/s/a56713cafbc5',
      },
      {
        name: 'æ–°æ¦‚å¿µè‹±é’å°‘å¹´ç‰ˆ',
        description: 'å„¿ç«¥è¯»ç‰©',
        difficulty: '7å²è‡³14å²',
        link: 'https://pan.quark.cn/s/9de8d7967de2',
      },
      {
        name: 'æ–°æ¦‚å¿µè‹±è¯­1-4 æ•™æé«˜æ¸… PDF',
        description: 'ä»… 1-4 å†Œçš„æ•™æé«˜æ¸…æ‰«æç‰ˆ PDF',
        difficulty: '',
        link: 'https://pan.quark.cn/s/ec49145d6b00',
      },
      {
        name: 'æ–°æ¦‚å¿µè®²è§£è§†é¢‘',
        description: 'å¤šå®¶æœºæ„/ä¸ªäººçš„è®²è§£è§†é¢‘',
        difficulty: '',
        link: 'https://pan.quark.cn/s/09e98acd55b4',
      },
      {
        name: 'æ–°æ¦‚å¿µåˆé›†',
        description: 'åŒ…å«å‰é¢çš„å†…å®¹',
        difficulty: '',
        link: 'https://pan.quark.cn/s/667e2e48eba4',
      },
    ],
  },
  {
    id: 'exam',
    name: 'ç”µè§†/ç”µå½±',
    icon: 'ğŸ¯',
    description: 'ä¸€äº›ä¸é”™çš„ç¾/è‹±å‰§ï¼Œå¯ç»ƒå¬åŠ›å’Œå£è¯­',
    resources: [
      {
        name: 'è€å‹è®°',
        description: '',
        difficulty: 'å–œå‰§/çˆ±æƒ…',
        link: 'https://pan.quark.cn/s/674834e7a5b1',
      },
      {
        name: 'ç”Ÿæ´»å¤§çˆ†ç‚¸',
        description: '',
        difficulty: 'å–œå‰§/çˆ±æƒ…',
        link: 'https://pan.quark.cn/s/0539c10704ba',
      },
      {
        name: 'æ˜¯å¤§è‡£/æ˜¯é¦–ç›¸',
        description: '',
        difficulty: 'å–œå‰§/è®½åˆº',
        link: 'https://pan.quark.cn/s/316323ce51d5',
      },
      {
        name: 'ç ´äº§å§å¦¹',
        description: '',
        difficulty: 'å–œå‰§',
        link: 'https://pan.quark.cn/s/40af6faaa19a',
      },
      {
        name: 'ç»æœ›ä¸»å¦‡',
        description: '',
        difficulty: 'æ‚¬ç–‘',
        link: 'https://pan.quark.cn/s/bcccdf9e788b',
      },
      {
        name: 'çº¸ç‰Œå±‹',
        description: '',
        difficulty: 'çº¸ç‰Œå±‹',
        link: 'https://pan.quark.cn/s/d2f3082508fd',
      },
      {
        name: 'ç”µè§†/ç”µå½±åˆé›†',
        description: 'åŒ…å«å‰é¢çš„å†…å®¹',
        difficulty: '',
        link: 'https://pan.quark.cn/s/84ecb30b700b',
      },
    ],
  },
  {
    id: 'grammar',
    name: 'è¯­æ³•å­¦ä¹ ',
    icon: 'ğŸ“',
    description: '',
    subcategories: [
      {
        name: 'ç»å…¸æ•™æ',
        description: '',
        resources: [
          {
            name: 'è‹±è¯­è¯­æ³•æ–°æ€ç»´',
            author: 'å¼ æ»¡èƒœ',
            features:'ä»æ€ç»´è§’åº¦è®²è§£è¯­æ³•ï¼Œæ³¨é‡ç†è§£è€Œéæ­»è®°ç¡¬èƒŒï¼Œåˆ†ä¸ºåˆçº§ã€ä¸­çº§ã€é«˜çº§ä¸‰å†Œï¼Œå¾ªåºæ¸è¿›',
            suitable:'å¸Œæœ›ç³»ç»Ÿå»ºç«‹è¯­æ³•ä½“ç³»çš„å­¦ä¹ è€…',
            difficulty: '',
            link: 'https://pan.quark.cn/s/d06abef6c737',
          },
          {
            name: 'è–„å†°è‹±è¯­è¯­æ³•',
            author: 'è–„å†°',
            features:'è€ç‰Œç»å…¸,ä½“ç³»å®Œæ•´,åˆ†ç±»éå¸¸ç»†,æŸ¥è¯­æ³•ç‚¹æ–¹ä¾¿',
            suitable:'ä¸­å­¦ç”Ÿæˆ–åŸºç¡€è¾ƒå¼±çš„å­¦ä¹ è€…',
            difficulty: '',
            link: 'https://pan.quark.cn/s/30777ceba5b9',
          },
          {
            name: 'å®ç”¨è‹±è¯­è¯­æ³•',
            author: 'å¼ é“çœŸ',
            features:'å›½å†…ç»å…¸è¯­æ³•æ•™æï¼Œå†…å®¹è¯¦å®å…¨é¢ï¼Œä¾‹å¥ä¸°å¯Œï¼Œé€‚åˆä½œä¸ºå·¥å…·ä¹¦æŸ¥é˜…',
            suitable:'éœ€è¦æƒå¨å‚è€ƒä¹¦çš„å­¦ç”Ÿæˆ–æ•™å¸ˆ',
            difficulty: '',
            link: 'https://pan.baidu.com/s/xxx',
          },
          {
            name: 'æ—‹å…ƒä¼°æ–‡æ³•',
            author: 'æ—‹å…ƒä¼°',
            features:'ä»¥é€šä¿—æ˜“æ‡‚çš„è¯­è¨€è§£æå¤æ‚è¯­æ³•ï¼Œå¼ºè°ƒâ€œç†è§£é€»è¾‘â€ï¼Œé€‚åˆçªç ´è¯­æ³•éš¾ç‚¹',
            suitable:'å¯¹ä¼ ç»Ÿè¯­æ³•æ•™å­¦æ„Ÿåˆ°æ¯ç‡¥ï¼Œæƒ³è½»æ¾æŒæ¡æ ¸å¿ƒé€»è¾‘çš„å­¦ä¹ è€…',
            difficulty: 'ç¹ä½“ä¸­æ–‡ç‰ˆ',
            link: 'https://pan.quark.cn/s/0d0de559794e',
          },
        ],
      },
      {
        name: 'è¿›é˜¶æå‡',
        description: '',
        resources: [
          {
            name: 'å‰‘æ¡¥è‹±è¯­è¯­æ³•(English Grammar in Use)',
            author: 'å‰‘æ¡¥å¤§å­¦å‡ºç‰ˆ',
            features:'åˆ†ä¸ºåˆçº§ã€ä¸­çº§ã€é«˜çº§ä¸‰å†Œï¼Œç»å…¸ç•…é”€è¯­æ³•è‡ªå­¦ä¹¦ï¼Œè§£é‡Šç®€æ˜ä¸”æœ‰å¤§é‡ç»ƒä¹ ',
            suitable:'éœ€è¦ç»“åˆå›½é™…è€ƒè¯•çš„å­¦ä¹ è€…',
            description: '',
            difficulty: 'ä¸­æ–‡ç‰ˆ',
            link: 'https://pan.quark.cn/s/d4a6ef53c04d',
          },
          {
            name: 'Oxford English Grammar(ç‰›æ´¥è‹±è¯­è¯­æ³•)',
            author: 'Sidney Greenbaum & Gerald Nelson',
            features:'åˆ†ä¸ºåŸºç¡€ã€æå‡ã€é«˜çº§ä¸‰å†Œï¼Œè‹±å¼è¯­æ³•æƒå¨ï¼Œè§£é‡Šæ¸…æ™°ã€ä¾‹å¥åœ°é“ï¼Œé€‚åˆå¤‡è€ƒé›…æ€/æ‰˜ç¦',
            suitable:'æƒ³å…¨é¢ç³»ç»Ÿæ¢³ç†è¯­æ³•ä½“ç³»çš„äºº',
            difficulty: 'è‹±æ–‡ç‰ˆ',
            link: 'https://pan.quark.cn/s/ca505875e68c',
          },
          {
            name: 'å®ç”¨è‹±è¯­ç”¨æ³•(Practical English Usage)',
            author: 'Michael Swan',
            features:'è§£é‡Šéå¸¸ç»†è‡´ï¼Œå°¤å…¶é€‚åˆçº æ­£å¸¸è§é”™è¯¯å’Œå›°æƒ‘',
            suitable:'ä¸­é«˜çº§å­¦ä¹ è€…ï¼Œé€‚åˆä½œä¸ºè¯­æ³•é—®é¢˜çš„å·¥å…·ä¹¦',
            difficulty: 'ä¸­æ–‡ç‰ˆ/è‹±æ–‡ç‰ˆ',
            link: 'https://pan.quark.cn/s/05006e705a77',
          },
        ],
      },
    ],
  },
  {
    id: 'listening',
    name: 'å¬åŠ›è®­ç»ƒ',
    icon: 'ğŸ§',
    description: 'æå‡è‹±è¯­å¬åŠ›æ°´å¹³',
    resources: [
      {
        name: 'VOAæ…¢é€Ÿè‹±è¯­åˆé›†',
        description: 'æ–°é—»ç±»å¬åŠ›ææ–™ï¼Œè¯­é€Ÿé€‚ä¸­ï¼Œå†…å®¹ä¸°å¯Œ',
        difficulty: 'åˆçº§',
        link: 'https://pan.quark.cn/s/23fc83043ca4',
      },
      // {
      //   name: 'BBC Learning English',
      //   description: 'BBCå®˜æ–¹è‹±è¯­å­¦ä¹ èµ„æºï¼Œæ¶µç›–å¤šæ–¹é¢å†…å®¹',
      //   difficulty: 'ä¸­é«˜çº§',
      //   link: 'https://pan.baidu.com/s/xxx',
      // },
      {
        name: 'TED-ED ç§‘æ™®åŠ¨ç”»',
        description: 'TED-Ed æ˜¯ä¸€ä¸ªä¸“ä¸ºåˆé«˜ä¸­ç”Ÿæ‰€è®¾è®¡çš„åœ¨3åˆ°5åˆ†é’Ÿé•¿çš„ç§‘æ™®åŠ¨ç”»èª²ç¨‹',
        difficulty: 'åˆçº§',
        link: 'https://pan.quark.cn/s/e4c0182833ba',
      },
      {
        name: 'å“ˆå¼—æ¼”è®²',
        description: 'é«˜è´¨é‡æ¼”è®²ï¼Œé”»ç‚¼å¬åŠ›åŒæ—¶å¼€æ‹“è§†é‡',
        difficulty: 'ä¸­é«˜çº§',
        link: 'https://pan.quark.cn/s/f2bfa8a50d25',
      },
    ],
  },
])

// å½“å‰é€‰ä¸­çš„åˆ†ç±»
const selectedCategory = ref('all')

// ç­›é€‰åçš„èµ„æº
const filteredResources = computed(() => {
  if (selectedCategory.value === 'all') {
    return categories.value
  }
  return categories.value.filter(cat => cat.id === selectedCategory.value)
})

// è·³è½¬åˆ°ç½‘ç›˜é“¾æ¥
const openLink = (url: string) => {
  window.open(url, '_blank')
}

// æ ¹æ®éš¾åº¦è·å–å¯¹åº”çš„æ ·å¼ç±»
const getDifficultyClass = (difficulty: string) => {
  switch (difficulty) {
    case 'å…¥é—¨':
      return 'bg-green-500'
    case 'åŸºç¡€':
      return 'bg-blue-500'
    case 'ä¸­çº§':
      return 'bg-purple-500'
    case 'è¿›é˜¶':
      return 'bg-amber-500'
    case 'é«˜çº§':
      return 'bg-red-500'
    case 'å…¨çº§åˆ«':
      return 'bg-gray-500'
    default:
      return 'bg-blue-500'
  }
}
</script>

<template>
  <BasePage>
    <div class="flex flex-col items-center justify-center px-4 py-8">
      <!-- é¡µé¢æ ‡é¢˜ -->
      <div class="text-center mb-8">
        <h1 class="text-4xl font-bold mb-4">ğŸ“š è‹±è¯­å­¦ä¹ èµ„æºåˆ†äº«</h1>
        <p class="text-lg text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
          ä»¥ä¸‹æ˜¯æˆ‘æ•´ç†çš„ä¸ªäººæ”¶è—çš„ä¼˜è´¨è‹±è¯­å­¦ä¹ èµ„æºï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ï¼
        </p>
      </div>

      <!-- åˆ†ç±»ç­›é€‰ -->
      <div
        class="flex flex-wrap justify-center gap-2 mb-8 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md"
      >
        <BaseButton
          :type="selectedCategory === 'all' ? 'primary' : 'info'"
          @click="selectedCategory = 'all'"
        >
          å…¨éƒ¨èµ„æº
        </BaseButton>
        <BaseButton
          v-for="category in categories"
          :key="category.id"
          :type="selectedCategory === category.id ? 'primary' : 'info'"
          @click="selectedCategory = category.id"
        >
          {{ category.icon }} {{ category.name }}
        </BaseButton>
      </div>

      <!-- èµ„æºåˆ—è¡¨ -->
      <div class="w-full">
        <div v-for="category in filteredResources" :key="category.id" class="mb-12">
          <div class="text-center mb-6">
            <h2 class="text-2xl font-bold mb-2">{{ category.icon }} {{ category.name }}</h2>
            <p v-if="category.description" class="text-gray-600 dark:text-gray-300">
              {{ category.description }}
            </p>
          </div>

          <!-- å¦‚æœæœ‰å­åˆ†ç±»ï¼Œæ˜¾ç¤ºå­åˆ†ç±» -->
          <template v-if="category.subcategories">
            <div
              v-for="subcategory in category.subcategories"
              :key="subcategory.name"
              class="mb-10"
            >
              <div class="text-center mb-4">
                <h3 class="text-xl font-semibold mb-2 text-gray-800 dark:text-gray-200">
                  {{ subcategory.name }}
                </h3>
                <p v-if="subcategory.description" class="text-gray-600 dark:text-gray-300">
                  {{ subcategory.description }}
                </p>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
                <div
                  v-for="resource in subcategory.resources"
                  :key="resource.name"
                  class="card-white min-h-45 mb-0 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 flex flex-col justify-between"
                >
                  <div class="">
                    <div class="text-xl font-semibold mb-3 text-gray-800 dark:text-gray-100">
                      {{ resource.name }}
                    </div>
                    <div class="space-y-2 mb-4">
                      <p v-if="resource.author" class="text-sm text-gray-600 dark:text-gray-300">
                        <span class="font-medium">ğŸ“ ä½œè€…ï¼š</span>{{ resource.author }}
                      </p>
                      <p v-if="resource.features" class="text-sm text-gray-600 dark:text-gray-300">
                        <span class="font-medium">ğŸŒŸ ç‰¹ç‚¹ï¼š</span>{{ resource.features }}
                      </p>
                      <p v-if="resource.suitable" class="text-sm text-gray-600 dark:text-gray-300">
                        <span class="font-medium">ğŸ“Œ é€‚åˆï¼š</span>{{ resource.suitable }}
                      </p>
                      <p v-if="resource.description" class="text-sm text-gray-600 dark:text-gray-300">
                        {{ resource.description }}
                      </p>
                      <span
                        v-if="resource.difficulty"
                        class="inline-block px-3 py-1 rounded-full text-xs font-medium text-white"
                        :class="getDifficultyClass(resource.difficulty)"
                      >
                        {{ resource.difficulty }}
                      </span>
                    </div>
                  </div>
                  <div class="flex flex-col gap-3">
                    <BaseButton type="primary" @click="openLink(resource.link)">
                      æ‰“å¼€é“¾æ¥
                    </BaseButton>
                  </div>
                </div>
              </div>
            </div>
          </template>

          <!-- å¦‚æœæ²¡æœ‰å­åˆ†ç±»ï¼Œç›´æ¥æ˜¾ç¤ºèµ„æº -->
          <template v-else>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
              <div
                v-for="resource in category.resources"
                :key="resource.name"
                class="card-white min-h-45 mb-0 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 flex flex-col justify-between"
              >
                <div class="">
                  <div class="text-xl font-semibold mb-3 text-gray-800 dark:text-gray-100">
                    {{ resource.name }}
                  </div>
                  <div class="space-y-2 mb-4">
                    <p v-if="resource.author" class="text-sm text-gray-600 dark:text-gray-300">
                      <span class="font-medium">ğŸ“ ä½œè€…ï¼š</span>{{ resource.author }}
                    </p>
                    <p v-if="resource.features" class="text-sm text-gray-600 dark:text-gray-300">
                      <span class="font-medium">ğŸŒŸ ç‰¹ç‚¹ï¼š</span>{{ resource.features }}
                    </p>
                    <p v-if="resource.suitable" class="text-sm text-gray-600 dark:text-gray-300">
                      <span class="font-medium">ğŸ“Œ é€‚åˆï¼š</span>{{ resource.suitable }}
                    </p>
                    <p v-if="resource.description" class="text-sm text-gray-600 dark:text-gray-300">
                      {{ resource.description }}
                    </p>
                    <span
                      v-if="resource.difficulty"
                      class="inline-block px-3 py-1 rounded-full text-xs font-medium text-white"
                      :class="getDifficultyClass(resource.difficulty)"
                    >
                      {{ resource.difficulty }}
                    </span>
                  </div>
                </div>
                <div class="flex flex-col gap-3">
                  <BaseButton type="primary" @click="openLink(resource.link)"> æ‰“å¼€é“¾æ¥ </BaseButton>
                </div>
              </div>
            </div>
          </template>
        </div>
      </div>

      <!-- é¡µé¢åº•éƒ¨ -->
      <div class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-700">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
          <h3 class="text-xl font-bold mb-4">ğŸ’¡ æ¸©é¦¨æç¤º</h3>
          <ul class="list-disc list-inside space-y-2 text-gray-600 dark:text-gray-300">
            <li>æ‰€æœ‰èµ„æºå‡æ¥è‡ªäº’è”ç½‘æ”¶é›†ï¼Œä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨</li>
            <li>å¦‚æœé“¾æ¥å¤±æ•ˆï¼Œè¯·åŠæ—¶<a :href="`https://v.wjx.cn/vm/ev0W7fv.aspx#`"
                                       target="_blank">å‘ŠçŸ¥</a>ï¼Œæˆ‘ä¼šå°½å¿«æ›´æ–°</li>
          </ul>
        </div>
      </div>
    </div>
  </BasePage>
</template>
